@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: "Literata";
  src: url("./fonts/Literata-VariableFont_opsz,wght.ttf") format("truetype");
  font-weight: 200 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Literata";
  src: url("./fonts/Literata-Italic-VariableFont_opsz,wght.ttf") format("truetype");
  font-weight: 200 900;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Jinghua";
  src: url("./fonts/JinghuaOldSong.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

:root {
  --vp-font-family-base: "Jinghua", "Literata", serif !important;
  --vp-font-family-mono: "JetBrains Mono", monospace !important;
}

@layer base {
  :root,
  .light {
    color-scheme: light;
    --color-primary: 105 132 116;
    --color-background: 252 248 243;
    --color-surface: 243 236 226;
    --color-text-main: 43 43 43;
    --color-text-muted: 102 98 92;
    --color-border: 221 213 201;
  }

  .dark {
    color-scheme: dark;
    --color-primary: 143 174 155;
    --color-background: 26 26 26;
    --color-surface: 36 36 36;
    --color-text-main: 245 243 238;
    --color-text-muted: 183 176 165;
    --color-border: 58 58 58;
  }

  html {
    @apply bg-background text-text-main antialiased;
    font-family: "Jinghua", "Literata", serif;
    font-size: 16px;
  }

  body {
    @apply m-0 min-h-screen bg-[#fcf8f3] text-base text-gray-900 dark:bg-[#1a1a1a] dark:text-gray-100;
    font-family: "Jinghua", "Literata", serif;
  }

  h1,
  h2,
  h3,
  .site-title,
  .blog-title,
  .artistic-text {
    font-family: "Jinghua", "Literata", serif;
  }

  ::selection {
    background: rgb(var(--color-primary) / 0.2);
  }

  a {
    @apply text-primary;
  }

  .vp-doc p,
  .vp-doc li,
  .vp-doc h1,
  .vp-doc h2,
  .vp-doc h3,
  .vp-doc h4,
  .vp-doc h5,
  .vp-doc h6 {
    font-family: "Jinghua", serif !important;
  }
}

@layer components {
  .prose {
    @apply text-base text-text-main md:text-lg;
    font-family: "Jinghua", "Literata", serif;
    line-height: 1.82;
    letter-spacing: 0.003em;
  }

  .prose :where(h1, h2, h3) {
    font-family: "Jinghua", "Literata", serif;
    letter-spacing: 0.01em;
  }

  .prose :where(p, li) {
    @apply text-text-main;
  }

  .prose :where(ul, ol) {
    margin-top: 0.8em;
    margin-bottom: 0.8em;
  }

  .prose :where(li) {
    margin-top: 0.25em;
    margin-bottom: 0.25em;
    line-height: 1.55;
  }

  .prose :where(strong) {
    @apply text-text-main;
  }

  .prose :where(a) {
    @apply decoration-primary/50 underline-offset-4 transition-colors;
  }

  .prose :where(a:hover) {
    @apply text-text-main;
  }

  .prose :where(code):not(:where(pre code)) {
    @apply rounded px-1.5 py-0.5 font-medium;
    color: rgb(var(--color-primary));
    background-color: rgb(var(--color-surface));
    font-family: "JetBrains Mono", "SFMono-Regular", Menlo, Monaco, Consolas, monospace;
  }

  .prose :where(code):not(:where(pre code))::before,
  .prose :where(code):not(:where(pre code))::after {
    content: none !important;
  }

  .vp-doc div[class*="language-"] {
    @apply relative my-6 overflow-hidden rounded-lg;
    margin-left: 0 !important;
    margin-right: 0 !important;
    border: none !important;
    background: #1e1e1e;
    box-shadow: none;
  }

  .dark .vp-doc div[class*="language-"] {
    background: #0d0d0d;
  }

  .vp-doc div[class*="language-"] pre {
    @apply m-0 overflow-x-auto px-4 py-4;
    background: transparent !important;
  }

  .vp-doc div[class*="language-"] code {
    @apply text-[13px] leading-6;
    font-family: "JetBrains Mono", "SFMono-Regular", Menlo, Monaco, Consolas, monospace;
  }

  .vp-doc div[class*="language-"] > span.lang,
  .vp-doc div[class*="language-"] > .line-numbers-wrapper,
  .vp-doc div[class*="language-"] > .code-filename {
    display: none !important;
  }

  div[class*="language-"] > button.copy {
    @apply absolute right-3 top-3 z-30 block h-8 w-8 rounded border border-border bg-surface bg-center bg-no-repeat opacity-0 transition-all duration-200;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='%23adbaaa' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E");
    background-size: 18px;
  }

  .dark div[class*="language-"] > button.copy {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='%239ca3af' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E");
    background-color: rgba(40, 40, 40, 0.8);
  }

  div[class*="language-"] > button.copy.copied {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='%2310b981' stroke-width='2' viewBox='0 0 24 24'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E");
    border-color: rgb(var(--color-primary));
    opacity: 100 !important;
  }

  div[class*="language-"] > button.copy::after,
  div[class*="language-"] > button.copy.copied::after {
    content: "" !important;
  }

  div[class*="language-"]:hover > button.copy,
  div[class*="language-"] > button.copy:focus {
    @apply opacity-100;
  }

  .prose :where(blockquote) {
    @apply border-primary/50 bg-surface/70 text-text-main;
    border-left-width: 3px;
    border-radius: 4px;
    padding: 0.9rem 1rem;
  }

  /* Table Reset */
  .vp-doc table {
    display: block;
    border-collapse: collapse;
    margin: 20px 0;
    overflow-x: auto;
    width: 100%;
  }

  .vp-doc tr {
    background-color: transparent;
    border-top: 1px solid #e5e7eb;
  }

  .dark .vp-doc tr {
    border-top: 1px solid #374151;
  }

  .vp-doc th,
  .vp-doc td {
    border: none;
    padding: 12px 16px;
  }

  .vp-doc th {
    font-weight: 600;
    background-color: transparent;
    text-align: left;
  }

  .dark .vp-doc strong {
    color: #fff !important;
  }

  .prose :where(h1, h2, h3, h4, h5, h6, strong, th, td) {
    color: rgb(var(--color-text-main)) !important;
  }

  /* Preserve Shiki syntax highlighting */
  html.dark .shiki,
  html.dark .shiki span {
    background-color: var(--shiki-dark-bg) !important;
    color: var(--shiki-dark) !important;
  }

  html:not(.dark) .shiki,
  html:not(.dark) .shiki span {
    background-color: var(--shiki-light-bg) !important;
    color: var(--shiki-light) !important;
  }
}
